pipeline {
  agent { docker { image 'python:3.9.2' } }
  agent { docker { image 'python:3.8.4' } }
  stages {
    stage('build') {
      steps {
        sh '''
            python --version
            python -m venv .venv
            . .venv/bin/activate
            pip install Flask
            python setup.py develop
            touch dbconfig.py
            python ./setup.py develop
            pip install coveralls
            python ./setup.py compile_catalog
        '''
      }
    }
    stage('test') {
      steps {
        sh '''
            . .venv/bin/activate
            TRAVIS=1 nosetests --force-color
        '''
      }   
    }
  }
}


// vim: et ts=2 sw=2
